<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi Amplicon - a small example • MultiAmplicon</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MultiAmplicon</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MultiAmplicon-small-example.html">Multi Amplicon - a small example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Multi Amplicon - a small example</h1>
                        <h4 class="author">Emanuel Heitlinger</h4>
            
            <h4 class="date">2018-04-04</h4>
          </div>

    
    
<div class="contents">
<div id="multi-amplicon---a-small-example" class="section level1">
<h1 class="hasAnchor">
<a href="#multi-amplicon---a-small-example" class="anchor"></a>Multi Amplicon - a small example</h1>
<div id="preparing-sequencing-read-files-and-a-primer-set" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-sequencing-read-files-and-a-primer-set" class="anchor"></a>Preparing sequencing read files and a primer set</h2>
<p>The MultiAmplicon package used dedicated classes to ensure that input to its <code>sortAmplicons</code> function is provided correctly. This means for the user that file names (and complete paths the directory they are stored in) of forward and reverse read files must be provided as a <code>PairedReadFileSet</code>. Similarly, primer pairs must be provided in a <code>PrimerPairsSet</code>. We first have a look at how these are generated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressMessages</span>(<span class="kw">library</span>(MultiAmplicon))

primerF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Amp1F =</span> <span class="st">"AGAGTTTGATCCTGGCTCAG"</span>, <span class="dt">Amp2F =</span> <span class="st">"ACTCCTACGGGAGGCAGC"</span>,
             <span class="dt">Amp3F =</span> <span class="st">"GAATTGACGGAAGGGCACC"</span>, <span class="dt">Amp4F =</span> <span class="st">"YGGTGRTGCATGGCCGYT"</span>,
             <span class="dt">Amp5F =</span> <span class="st">"AAAAACCCCGGGGGGTTTTT"</span>, <span class="dt">Amp6F =</span> <span class="st">"AGAGTTTGATCCTGCCTCAG"</span>)

primerR &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Amp1R =</span> <span class="st">"CTGCWGCCNCCCGTAGG"</span>, <span class="dt">Amp2R =</span> <span class="st">"GACTACHVGGGTATCTAATCC"</span>,
             <span class="dt">Amp3R =</span> <span class="st">"AAGGGCATCACAGACCTGTTAT"</span>, <span class="dt">Amp4R =</span> <span class="st">"TCCTTCTGCAGGTTCACCTAC"</span>,
             <span class="dt">Amp5R =</span> <span class="st">"AAAAACCCCGGGGGGTTTTT"</span>, <span class="dt">Amp6R =</span> <span class="st">"CCTACGGGTGGCAGATGCAG"</span>)

PPS &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PrimerPairsSet-class.html">PrimerPairsSet</a></span>(primerF, primerR)

fastq.dir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"fastq"</span>, <span class="dt">package =</span> <span class="st">"MultiAmplicon"</span>)
fastq.files &lt;-<span class="st"> </span><span class="kw">list.files</span>(fastq.dir, <span class="dt">full.names=</span><span class="ot">TRUE</span>)

Ffastq.file &lt;-<span class="st"> </span>fastq.files[<span class="kw">grepl</span>(<span class="st">"F_filt"</span>, fastq.files)]
Rfastq.file &lt;-<span class="st"> </span>fastq.files[<span class="kw">grepl</span>(<span class="st">"R_filt"</span>, fastq.files)]

PRF &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PairedReadFileSet-class.html">PairedReadFileSet</a></span>(Ffastq.file, Rfastq.file)

MA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/MultiAmplicon-class.html">MultiAmplicon</a></span>(PPS, PRF)</code></pre></div>
</div>
<div id="sorting-into-multiple-amplicons" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting-into-multiple-amplicons" class="anchor"></a>Sorting into multiple amplicons</h2>
<p>Based on the primer sequences we can now sort the sequences into amplicons. This is done by the function <code>sortAmplicons</code>, which updates the MultiAmplicon object with the sorted amplicons.</p>
<p>For this small example dataset we can look at the resuling <code>rawCounts</code> i.e. the number of sequences for each of the fully stratified amplicon x sample matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MA1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sortAmplicons.html">sortAmplicons</a></span>(MA)
<span class="co">#&gt; using existing directory  /tmp/RtmpJ8JLNl and adding specific prefixes to avoid problems when running code twice </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 0 sequencing reads for S0_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S0_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S0_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  0 amplicons </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 0 sequencing reads for S00_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S00_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S00_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  0 amplicons </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 1 sequencing reads for S01_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S01_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S01_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  1 amplicons </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 9348 sequencing reads for S121_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S121_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S121_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  4 amplicons </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 5 sequencing reads for S144_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S144_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S144_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  1 amplicons </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 16 sequencing reads for S22_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S22_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S22_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  4 amplicons </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 63448 sequencing reads for S8_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S8_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S8_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  4 amplicons </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  finished  sorting 7108 sequencing reads for S91_F_filt.fastq.gz in </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S91_F_filt.fastq.gz  and </span>
<span class="co">#&gt;   /usr/local/lib/R/site-library/MultiAmplicon/extdata/fastq/S91_R_filt.fastq.gz </span>
<span class="co">#&gt;   into  4 amplicons</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">kable</span>(<span class="kw"><a href="../reference/MultiAmplicon-class.html">rawCounts</a></span>(MA1))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">S0_F_filt.fastq.gz</th>
<th align="right">S00_F_filt.fastq.gz</th>
<th align="right">S01_F_filt.fastq.gz</th>
<th align="right">S121_F_filt.fastq.gz</th>
<th align="right">S144_F_filt.fastq.gz</th>
<th align="right">S22_F_filt.fastq.gz</th>
<th align="right">S8_F_filt.fastq.gz</th>
<th align="right">S91_F_filt.fastq.gz</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Amp1F.Amp1R</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3495</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">29310</td>
<td align="right">2569</td>
</tr>
<tr class="even">
<td>Amp2F.Amp2R</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2949</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">20391</td>
<td align="right">2690</td>
</tr>
<tr class="odd">
<td>Amp3F.Amp3R</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1817</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">11671</td>
<td align="right">1421</td>
</tr>
<tr class="even">
<td>Amp4F.Amp4R</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1087</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">2076</td>
<td align="right">428</td>
</tr>
<tr class="odd">
<td>Amp5F.Amp5R</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Amp6F.Amp6R</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Now we can plot the result. The function plotAmpliconNumbers allows us also to store clustering information (see ). Which can afterwards be used to filter data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clusters &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotAmpliconNumbers.html">plotAmpliconNumbers</a></span>(MA1)</code></pre></div>
<p><img src="MultiAmplicon-small-example_files/figure-html/plotAmpliconNumbers-1.png" width="672"></p>
<p>We can use this clustering information to subset our MultiAmplicon object.</p>
<p>You can enable figure captions by <code>fig_caption: yes</code> in YAML:</p>
<pre><code>output:
  rmarkdown::html_vignette:
    fig_caption: yes</code></pre>
<p>Then you can use the chunk option <code>fig.cap = "Your figure caption."</code> in <strong>knitr</strong>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#multi-amplicon---a-small-example">Multi Amplicon - a small example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#preparing-sequencing-read-files-and-a-primer-set">Preparing sequencing read files and a primer set</a></li>
      <li><a href="#sorting-into-multiple-amplicons">Sorting into multiple amplicons</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Emanuel Heitlinger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
