<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>sortAmplicons — sortAmplicons • MultiAmplicon</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MultiAmplicon</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MultiAmplicon-real-world-example.html">MultiAmplicon - a real world example</a>
    </li>
    <li>
      <a href="../articles/MultiAmplicon-small-example.html">MultiAmplicon - a small example</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>sortAmplicons</h1>
    </div>

    
    <p>Sort different amplicons into a fully stratified samples x
amplicons structure based on primer matches.</p>
    

    <pre class="usage"><span class='fu'>sortAmplicons</span>(<span class='no'>MA</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1e+06</span>, <span class='kw'>countOnly</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>rmPrimer</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>filedir</span> <span class='kw'>=</span> <span class='fu'>tempdir</span>(), <span class='no'>...</span>)

<span class='co'># S4 method for MultiAmplicon</span>
<span class='fu'>sortAmplicons</span>(<span class='no'>MA</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1e+06</span>, <span class='kw'>countOnly</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>rmPrimer</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>filedir</span> <span class='kw'>=</span> <span class='fu'>tempdir</span>(), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>MA</th>
      <td><p><code><a href='MultiAmplicon-class.html'>MultiAmplicon-class</a></code> object containing a
set of paired end files and a primer-pairs set.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>parameter passed to the yield functions of package
ShortRead. This controls the memory consumption during
streaming. Lower values result in lower memory requirements
but might result longer processing time due to more repeated
I/O operations reading the sequence files.</p></td>
    </tr>
    <tr>
      <th>countOnly</th>
      <td><p>logical argument if set TRUE only a matrix of
read counts is returned</p></td>
    </tr>
    <tr>
      <th>rmPrimer</th>
      <td><p>logical, indicating whether primer sequences
should be removed during sorting</p></td>
    </tr>
    <tr>
      <th>filedir</th>
      <td><p>path to an existing or newly to be created folder
on your computer. <code><a href='http://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></code> is used within
this folder to create unique filnames trying to avoid problems
in case the folder has been used before.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameter so be passed to
Biostrings::isMatchingStartingAt. Be careful when using
multiple starting positions or allowing error. This could lead
to read pairs being assigned to multiple amplicons.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>MultiAmplicon: By default (countOnly=FALSE) a
    <code><a href='MultiAmplicon-class.html'>MultiAmplicon-class</a></code> object is returned with the
    stratifiedFiles slot populated. Stratified file names are
    constructed using a unique string created by
    <code><a href='http://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></code> and stored in the given filedir
    (by default R's <code><a href='http://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></code>). If the countOnly
    is set only a numeric matrix of read counts is returned.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses <code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingStartingAt</a></code>
to match primer sequences at the first position of forward and
reverse sequences. These primer sequences can be removed. The
remaining sequences of interest are written to (temporary) files
to allow processing via standard metabarcoding pipelines.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>primerF</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"AGAGTTTGATCCTGGCTCAG"</span>, <span class='st'>"ACTCCTACGGGAGGCAGC"</span>,
            <span class='st'>"GAATTGACGGAAGGGCACC"</span>, <span class='st'>"YGGTGRTGCATGGCCGYT"</span>)
<span class='no'>primerR</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"CTGCWGCCNCCCGTAGG"</span>, <span class='st'>"GACTACHVGGGTATCTAATCC"</span>,
             <span class='st'>"AAGGGCATCACAGACCTGTTAT"</span>, <span class='st'>"TCCTTCTGCAGGTTCACCTAC"</span>)

<span class='no'>PPS</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='PrimerPairsSet-class.html'>PrimerPairsSet</a></span>(<span class='no'>primerF</span>, <span class='no'>primerR</span>)

<span class='no'>fastq.dir</span> <span class='kw'>&lt;-</span> <span class='fu'>system.file</span>(<span class='st'>"extdata"</span>, <span class='st'>"fastq"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"MultiAmplicon"</span>)
<span class='no'>fastq.files</span> <span class='kw'>&lt;-</span> <span class='fu'>list.files</span>(<span class='no'>fastq.dir</span>, <span class='kw'>full.names</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>Ffastq.file</span> <span class='kw'>&lt;-</span> <span class='no'>fastq.files</span>[<span class='fu'>grepl</span>(<span class='st'>"F_filt"</span>, <span class='no'>fastq.files</span>)]
<span class='no'>Rfastq.file</span> <span class='kw'>&lt;-</span> <span class='no'>fastq.files</span>[<span class='fu'>grepl</span>(<span class='st'>"R_filt"</span>, <span class='no'>fastq.files</span>)]

<span class='no'>PRF</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='PairedReadFileSet-class.html'>PairedReadFileSet</a></span>(<span class='no'>Ffastq.file</span>, <span class='no'>Rfastq.file</span>)

<span class='no'>MA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='MultiAmplicon-class.html'>MultiAmplicon</a></span>(<span class='no'>PPS</span>, <span class='no'>PRF</span>)

<span class='co'>## sort into amplicons</span>
<span class='no'>MA1</span> <span class='kw'>&lt;-</span> <span class='fu'>sortAmplicons</span>(<span class='no'>MA</span>)</div><div class='output co'>#&gt; <span class='message'>using existing directory /tmp/Rtmpt5VHLH and adding specific prefixes to avoid problems when running code twice</span></div><div class='output co'>#&gt; <span class='message'>finished sorting 0 sequencing reads for S00_F_filt.fastq.gz in</span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S00_F_filt.fastq.gz and </span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S00_R_filt.fastq.gz</span>
#&gt; <span class='message'> into 0 amplicons</span></div><div class='output co'>#&gt; <span class='message'>finished sorting 0 sequencing reads for S01_F_filt.fastq.gz in</span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S01_F_filt.fastq.gz and </span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S01_R_filt.fastq.gz</span>
#&gt; <span class='message'> into 0 amplicons</span></div><div class='output co'>#&gt; <span class='message'>finished sorting 9348 sequencing reads for S02_F_filt.fastq.gz in</span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S02_F_filt.fastq.gz and </span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S02_R_filt.fastq.gz</span>
#&gt; <span class='message'> into 4 amplicons</span></div><div class='output co'>#&gt; <span class='message'>finished sorting 5 sequencing reads for S03_F_filt.fastq.gz in</span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S03_F_filt.fastq.gz and </span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S03_R_filt.fastq.gz</span>
#&gt; <span class='message'> into 1 amplicons</span></div><div class='output co'>#&gt; <span class='message'>finished sorting 14 sequencing reads for S04_F_filt.fastq.gz in</span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S04_F_filt.fastq.gz and </span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S04_R_filt.fastq.gz</span>
#&gt; <span class='message'> into 3 amplicons</span></div><div class='output co'>#&gt; <span class='message'>finished sorting 51777 sequencing reads for S05_F_filt.fastq.gz in</span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S05_F_filt.fastq.gz and </span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S05_R_filt.fastq.gz</span>
#&gt; <span class='message'> into 3 amplicons</span></div><div class='output co'>#&gt; <span class='message'>finished sorting 17358 sequencing reads for S06_F_filt.fastq.gz in</span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S06_F_filt.fastq.gz and </span>
#&gt; <span class='message'> /localstorage/ele/git_projects/MultiAmplicon/inst/extdata/fastq/S06_R_filt.fastq.gz</span>
#&gt; <span class='message'> into 4 amplicons</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Emanuel Heitlinger

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Emanuel Heitlinger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
